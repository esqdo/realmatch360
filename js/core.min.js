app={version:"1.0",traceTime:0,isDebug:0,init:function(){this.button.init();this.form.combobox.init();this.page.background.init();this.page.footer.init();this.page.languageSwitcher.init()},log:function(){},enableDebug:function(){this.isDebug=1;if(window.console==null||typeof window.console.log!="function"){cl=function(){};app.log=function(){}}else{cl=console.log.bind(console);app.log=console.log.bind(console)}},disableDebug:function(){cl=function(){};app.log=function(){}},trace:function(c){if(!c){c=" std"}var a=new Date().getMilliseconds();if(app.traceTime==0){app.traceTime=a;app.log("start trace of "+c)}else{var b=a-app.traceTime;app.log("trace "+c+": "+b+"ms")}},htmlEscape:function(c,g,b){var e=0,d=0,f=false;if(typeof g==="undefined"||g===null){g=2}c=c.toString();if(b!==false){c=c.replace(/&/g,"&amp;")}c=c.replace(/</g,"&lt;").replace(/>/g,"&gt;");var a={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(g===0){f=true}if(typeof g!=="number"){g=[].concat(g);for(d=0;d<g.length;d++){if(a[g[d]]===0){f=true}else{if(a[g[d]]){e=e|a[g[d]]}}}g=e}if(g&a.ENT_HTML_QUOTE_SINGLE){c=c.replace(/'/g,"&#039;")}if(!f){c=c.replace(/"/g,"&quot;")}return c},hash:function(c){var d=0,b,a;c=""+c;if(c.length==0){return d}for(b=0,l=c.length;b<l;b++){a=c.charCodeAt(b);d=((d<<5)-d)+a;d|=0}if(d<-1){d=d*-1}return d},stopPropagation:function(b){if(!b){return false}try{b.stopPropagation();b.preventDefault()}catch(a){}try{b.cancelBubble=true;b.returnValue=false}catch(a){}},buildUrl:function(a,b){a+=((a.indexOf("?")==-1)?"?":"&");a+=app.queryString(b);return a},queryString:function(a){return $.param(a)},jsonEncode:function(c){var a,b;a=$(c).serializeArray();b={};$.each(a,function(){var d;if(this.value!=null){d=this.value}else{d=""}if(b[this.name]!=null){if(!b[this.name].push){b[this.name]=[b[this.name]]}b[this.name].push(d)}else{b[this.name]=d}});return b},clearTimeout:function(a){try{if(a){clearTimeout(a)}}catch(b){}},debounce:function(b,a){var c=null;return function(){var e=this,d=arguments;clearTimeout(c);c=setTimeout(function(){b.apply(e,d)},a)}},timeoutLocks:{},debounceGlobal:function(b,c,a){app.clearTimeout(app.timeoutLocks[b]);app.timeoutLocks[b]=setTimeout(function(){var e=this,d=arguments;c.apply(e,d)},a)},throttle:function(c,a,b){a||(a=250);var d,e;return function(){var h=b||this;var g=+new Date,f=arguments;if(d&&g<d+a){clearTimeout(e);e=setTimeout(function(){d=g;c.apply(h,f)},a)}else{d=g;c.apply(h,f)}}},responsive:function(b){var a=b.parents("div.content-tab-box");$(".nav-responsive",a).html(b.html())},responsiveHome:function(){var a=$(".cms iframe").parents("div.content-box").width();$("tr").removeAttr("height");$("iframe").attr("height",a/1.77).attr("width",a);$(".cms img").wrap("<p></p>")}};var cl=function(){};app.ajax={ajaxController:"/app/ajax.php",init:function(a){},post:function(b,e,f,c){if(!c||c==""||c=="undefined"){c="json"}if(!e||e==""||e=="undefined"){e={}}data={};if(e.data){data=e.data;delete e.data}if(e.form){data=e.form.serialize();delete e.form}if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}var d=window.location.origin;var a=d+app.ajax.ajaxController+"?call="+encodeURIComponent(b);$.post(a,{param:e,data:data},f,c)}};app.archiveReport={downloadArchiveReportPdf:function(c,a){var b="/report-msregion/downloadArchivePdf.html?msregion_id="+c+"&search_type=rent&date="+a;window.location.href=b}};app.button={init:function(){$("body").on("click",".btn[link]",function(){app.page.go($(this).attr("link"));return false})}};app.dict={lang:null,tokens:{},translate:function(a){if(app.dict.tokens[a]){a=app.dict.tokens[a]}else{if(app.isDebug){alert("Token missing: "+a)}a="["+a+"]"}if(arguments.length>=2){a=sprintf.apply(null,arguments)}return a}};app.element={highlight:function(a){$(a).effect("highlight")},autoPositionFixed:function(b){var b=$(b);var d=b.offset();var a=parseInt(d.top)+b.outerHeight(true)+10;b.after('<div class="autofixed-hk"></div>');var c=b.next();$(window).scroll(app.throttle(function(){if($(this).scrollTop()>a){if(!b.hasClass("autofixed")){var f=b.outerWidth(true);var e=b.outerHeight(true);b.addClass("autofixed");b.css("width",f);b.hide();b.fadeIn();c.css({height:e,width:"100%"})}}else{if(b.hasClass("autofixed")){b.removeClass("autofixed");b.css("width","");c.css({height:0,width:0})}}},75))}};app.exportCSV={downloadDetailAnalysisCSV:function(c){var h=$("#bfh-selectbox-msregion > input").attr("value");var g=$("#bfh-selectbox-city > input").attr("value");var a=$("#bfh-selectbox-objecttype > input").attr("value");var b=$("#bfh-selectbox-searchtype > input").attr("value");if(c=="filter"){var d=$(".report-drilldown-filter").attr("drilldownFilterType");var f=$(".report-drilldown-filter").attr("drilldownFilterValue")}else{var d=undefined;var f=undefined}var e="/report-city/downloadCSV.html?msregion_id="+h+"&city_id="+g+"&object_type="+a+"&search_type="+b+"&filter_type="+d+"&filter_value="+f+"&filter="+c;window.location.href=e}};app.form={init:function(){},getFormElement:function(a){if(typeof a=="string"||a instanceof String){return $("#form_"+a)}else{return $(a)}},submit:function(b){var a=this.getFormElement(b);if(a){app.page.spinnerShow();return a.submit()}},disable:function(b){var a=this.getFormElement(b);$(".app-button-submit",a).attr("disabled","disabled");$(".app-button-submit",a).addClass("disabled")},enable:function(b){var a=this.getFormElement(b);$(".app-button-submit",a).removeAttr("disabled");$(".app-button-submit",a).removeClass("disabled")},changeActionSubmit:function(c,b){var a=this.getFormElement(c);$("input[name='pto[action]']",a).val("-"+b);this.submit(a)},createToggleBox:function(b,a,c){$(document).ready(function(){var e=this.getFormElement(formId);var d=$("#"+a);var f=function(g){if(e.attr("checked")){if(g){d.slideDown()}else{d.show()}if(c){c(b,a,true)}}else{if(g){d.slideUp()}else{d.hide()}if(c){c(b,a,false)}}};e.click(function(){f(true)});f(false)})},toggleCheckbox:function(b){var a=b.attr("checked");b.attr("checked",!a)},serialize:function(b){var a=this.getFormElement(b);return app.jsonEncode(a)}};app.format={separatorDecimals:".",separatorThousands:"",dateFormat:"yyyy-mm-dd",timeFormat:"HH:MM:ss",dateTimeFormat:"yyyy-mm-dd HH:MM:ss",number:function(c,b,h,k){if(typeof h=="undefined"){h=app.format.separatorDecimals}if(typeof k=="undefined"){k=app.format.separatorThousands}b=parseInt(b);if(b>0){b=b}else{b=0;c=Math.round(c)}var a="";var d=c.toString();var j=d.indexOf("e");if(j>-1){a=d.substring(j);c=parseFloat(d.substring(0,j))}if(b!=0){var m=Math.pow(10,b);c=Math.round(c*m)/m}var n=c<0?"-":"";var g=(c>0?Math.floor(c):Math.abs(Math.ceil(c))).toString();var e=c.toString().substring(g.length+n.length);h=h!=null?h:".";e=b!=null&&b>0||e.length>1?(h+e.substring(1)):"";if(b!=null&&b>0){for(f=e.length-1,z=b;f<z;++f){e+="0"}}k=(k!=h||e.length==0)?k:null;if(k!=null&&k!=""){for(var f=g.length-3;f>0;f-=3){g=g.substring(0,f)+k+g.substring(f)}}return n+g+e+a},numberParse:function(a){a=a.replace(/\./g,"").replace(/,/,".");return parseFloat(a)},money:function(a){return app.format.number(a/100,2)},date:function(c){var d=c.substring(0,4);var e=c.substring(5,7);var b=c.substring(8,10);d=d.replace(/^[\s0]*/,"");e=e.replace(/^[\s0]*/,"");b=b.replace(/^[\s0]*/,"");d=parseInt(d);e=parseInt(e);b=parseInt(b);var a=new Date(d,e-1,b);return a.format(app.format.dateFormat)}};app.form.combobox={init:function(){$(".bfh-selectbox").each(function(){var a=$(this);var c=$("ul[role=option]",a);var b=$("li",c);if(b.length==0){app.form.combobox.disable(a)}else{app.form.combobox.enable(a)}})},setAutoselect:function(a){a.data("tq-autoselect",1);setTimeout(function(){app.form.combobox.checkAutoselect(a)},50)},disable:function(a){$("[data-toggle=bfh-selectbox]",$(a)).addClass("disabled");$("[data-toggle=bfh-selectbox]",$(a)).attr("disabled",true)},enable:function(a){$("[data-toggle=bfh-selectbox]",$(a)).removeClass("disabled");$("[data-toggle=bfh-selectbox]",$(a)).removeAttr("disabled")},checkAutoselect:function(b){var a=b.data("tq-autoselect");if(a==1){var e=$("ul[role=option]",b);var d=$("li",e);var c=d.first().find("[data-option]").data("option");b.val(c);b.trigger("change.bfhselectbox");return true}return false},setOptionList:function(b,e,a){var d=$("ul[role=option]",b);d.html("");var f=0;var c=null;$.each(e,function(g,j){f++;var h=null;var i=null;if($.isPlainObject(j)){h=j.value;i=j.title}else{h=g;i=j}if(c==null){c=g}d.append('<li><a tabindex="-1" href="#" data-option="'+app.htmlEscape(h)+'">'+app.htmlEscape(i)+"</a></li>")});b.val("");if(typeof a=="bool"||a==true){app.form.combobox.checkAutoselect(b)}b.addClass("open");$("ul[role=option]",b).scrollTop(0);b.removeClass("open");if(f==0){app.form.combobox.disable(b)}else{app.form.combobox.enable(b)}if(f<7){$(".bfh-selectbox-filter",b).addClass("hidden")}else{$(".bfh-selectbox-filter",b).removeClass("hidden")}}};app.page={overlayConf:{},init:function(){},go:function(a,b){window.location=a;app.stopPropagation(b)},reload:function(){var a=window.location.href;if(a.search(/\?/)!=-1){a=a+"&nc="+Math.floor(new Date().getTime()/1000)}else{a=a+"?nc="+Math.floor(new Date().getTime()/1000)}window.location.href=a},dialog:function(a,b){if(!b||b==""||b=="undefined"){b={}}if(!b.minHeight){b.minHeight=180}if(!b.maxHeight){b.maxHeight=300}if(!b.minWidth){b.minWidth=500}if(!b.maxWidth){b.maxWidth=600}b.resizable=false;b.modal=true;return $("#"+a).dialog(b)},bodySize:function(){return{height:$("#pageBodyWrapper").innerHeight(),width:$("#pageBodyWrapper").innerWidth()}},confirmOk:function(b,e,d){var c=app.dict.tokens.dialog_yes;var a=app.dict.tokens.dialog_cancel;if(!d){d={}}if(!d.buttons){d.buttons={}}d.buttons[a]=function(){$(this).dialog("close")};d.buttons[c]=function(){if(e){if(e($(this))){$(this).dialog("close")}}else{$(this).dialog("close")}};app.page.dialog(b,d)},confirmYesNo:function(b,e,d){var c=app.dict.tokens.dialog_yes;var a=app.dict.tokens.dialog_no;if(!d){d={}}if(!d.buttons){d.buttons={}}d.buttons[c]=function(){if(e){if(e($(this))){$(this).dialog("close")}}else{$(this).dialog("close")}};d.buttons[a]=function(){$(this).dialog("close")};app.page.dialog(b,d)},confirmDelete:function(b,e,d){var c=app.dict.tokens.dialog_delete;var a=app.dict.tokens.dialog_cancel;if(!d){d={}}if(!d.buttons){d.buttons={}}d.buttons[a]=function(){$(this).dialog("close")};d.buttons[c]=function(){if(e){if(e($(this))){$(this).dialog("close")}}else{$(this).dialog("close")}};app.page.dialog(b,d)},spinnerShow:function(){return;var b=$("#pageBodyWrapper").position();var c=$("#pageFooterWrapper").position();if(!$("body").hasClass("appPage1ColumnPopup")){var a=c.top-b.top+32}$("#pageSpinner").css("height",a).fadeIn("fast")},spinnerHide:function(){return;$("#pageSpinner").fadeOut()},overlayHandle:function(a){app.page.overlayConf=a;$(document).ready(function(){var c=$("#pageOverlayBg");var g=$("#pageOverlayBgClose");var d=-1;var f=function(){var h=0;var j=0;var i=$("#pageBodyColumnMiddle").offset();var h=i.left+$("#pageBodyColumnMiddle").outerWidth()-(g.outerWidth()/1.5);var j=i.top-(g.outerHeight()/2.5);g.css("left",h).css("top",j);g.show()};var e=function(){if(d==-1){d=window.setTimeout(f,10)}else{try{if(d){window.clearInterval(d)}}catch(h){}d=window.setTimeout(f,100)}};var b=function(){try{if(d){window.clearInterval(d)}}catch(h){}d=-1;g.hide()}})},overlaySetConf:function(a,b){$(document).ready(function(){app.page.overlayConf[a]=b})},overlayClose:function(){if(app.page.overlayConf.enableConfirmation){app.page.confirmYesNo("dialog-page-overlay-close",function(){app.page.go(app.page.overlayConf.returnUrl)})}else{app.page.go(app.page.overlayConf.returnUrl)}}};app.page.background={init:function(){var c=$(window);var a=$(a);var b=function(){var j=c.width(),d=c.height(),f=$("#bg");var h=[370,600,1000,1280,2500];var k=f.attr("src").match(/([0-9]+)/)?RegExp.$1:null;if(!k||((k<j)&&(k<h[h.length-1]))){var e=h[h.length-1];for(var g=0;g<h.length;g++){if(h[g]>=j){e=h[g];break}}f.attr("src","/static/img/bg/"+e+".jpg");app.log("Background: Using "+e)}if((j/d)<(f.width()/f.height())){f.css({height:"100%",width:"auto"})}else{f.css({width:"100%",height:"auto"})}};b=app.debounce(b,200);c.resize(b).resize();a.resize(b);setTimeout(b,500)}};app.page.footer={init:function(){var a=$("footer").outerHeight()+40;$("#page").css("padding-bottom",a)}};app.page.languageSwitcher={init:function(){$(".btn-language > .bfh-selectbox-options > div > ul > li").click(function(){selectedLanguageId=$(this).children("a").data("option");$.post(window.location.href,{useLanguageId:selectedLanguageId}).always(function(){window.location.href=window.location.href})})}};app.pdfGenerator={generatePDF:function(){$("#chart-main-title-box-canvas").empty();$("#chart-main-title-box").clone().appendTo("#chart-main-title-box-canvas");$("#report_facts_and_figures_box_canvas").empty();$("#report_facts_and_figures_box").clone().removeAttr("id").appendTo("#report_facts_and_figures_box_canvas");var b=new XMLSerializer().serializeToString(document.getElementById("report-rooms").getElementsByTagName("svg")[0]);var c=new XMLSerializer().serializeToString(document.getElementById("report-size").getElementsByTagName("svg")[0]);var f=new XMLSerializer().serializeToString(document.getElementById("report-price").getElementsByTagName("svg")[0]);canvg("report-rooms-canvas",b);canvg("report-size-canvas",c);canvg("report-price-canvas",f);var i='<img src="'+document.getElementById("report-rooms-canvas").toDataURL()+'">';var g='<img src="'+document.getElementById("report-size-canvas").toDataURL()+'">';var d='<img src="'+document.getElementById("report-price-canvas").toDataURL()+'" height="200" width="447">';$("#report-rooms-img").empty();$("#report-rooms-img").append('<h1 style="margin-bottom: 50px;">'+$("#report-rooms-title").text()+"</h1>");$("#report-rooms-img").append(i);$("#report-size-img").empty();$("#report-size-img").append('<h1 style="margin-bottom: 50px; margin-top: 100px;">'+$("#report-size-title").text()+"</h1>");$("#report-size-img").append(g);$("#report-price-img").empty();$("#report-price-img").append('<h1 style="margin-top: 450px;">'+$("#report-price-title").text()+"</h1>");$("#report-price-img").append(d);var e=new jsPDF("p","pt","letter");var a=document.getElementById("js-pdf-area");var h={"#bypassme":function(j,k){return true}};margins={top:40,bottom:60,left:40,width:522};e.fromHTML(a,margins.left,margins.top,{width:margins.width,elementHandlers:h},function(j){var k=$("#report_facts_and_figures_title").text();e.output("save",k+".pdf")},margins)}};app.report={chartInstances:{},chartIgnoreUpdate:{},tooltipCache:{},tooltipTimeoutLock:false,bar:function(e,a){var c=false;var b=$("#report-"+e);if(app.report.chartIgnoreUpdate[e]){app.report.chartIgnoreUpdate[e]=false;return}if(app.report.chartInstances[e]){c=app.report.chartInstances[e]}else{b.addClass("loading")}if(c){c.highcharts().showLoading()}if(!a||a==""||a=="undefined"){a={}}var a=$.extend({filter:{},chart:{}},a);var d=a.filter;app.report.tooltipCache={};app.ajax.post("reportChart."+e,d,function(f){if(!f){c.highcharts().hideLoading();return}if(c){app.report.updateChart(c,a,f);c.highcharts().hideLoading()}else{app.report.chartInstances[e]=app.report.createBar(b,a,f)}b.removeClass("loading");if(f.debug){app.log(e,f.debug)}})},setIgnoreNextUpdate:function(a){app.report.chartIgnoreUpdate[a]=1},createBar:function(e,c,a){var d=false;var f=false;if(!c){c={}}var b=$.extend(true,{chart:{type:"column",margin:[10,10,80,50]},colors:["#d40f14","#F7CECF"],title:{text:""},xAxis:{categories:[],labels:{rotation:-45,align:"right",style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}},title:{text:"",style:{color:"#095B60"}}},yAxis:{min:0,allowDecimals:false,title:{text:""}},legend:{enabled:false},tooltip:{formatter:function(){var i=this;if(c.tooltipLocal){var h=c.tooltipLocal(i,f)}else{var j='<span class="number">'+app.format.number(i.y)+"</span>";var g=app.dict.translate("chart_tooltip_title",j);var h="<h3>"+g+"</h3>"}if(c.tooltipRemote){var k=app.hash("#"+i.y+"#"+i.id);var m="tooltip-"+k;h+='<div id="'+m+'" class="chart-tooltip-adv loading"></div>';app.report.remoteTooltip(m,i,c)}return h},useHTML:true,borderWidth:0,backgroundColor:"transparent",shadow:false},plotOptions:{column:{stacking:"normal",pointPadding:0.2,borderWidth:0},series:{cursor:"pointer",allowPointSelect:true,marker:{states:{select:{lineWidth:0}}},point:{events:{click:function(g){if(c.drilldown){c.drilldown(this,g)}}}}}},credits:{enabled:false}},c.chart);d=$(e).highcharts(b);f=d.highcharts();this.updateChart(d,c,a);return d},remoteTooltip:function(d,b,a){var c=250;if(app.report.tooltipCache[d]){c=25}app.debounceGlobal("report.remoteTooltip",function(){var f=$("#"+d);var e=function(g){f.removeClass("loading");f.html(g);if(!app.isDebug){app.report.tooltipCache[d]=g}};if(app.report.tooltipCache[d]){e(app.report.tooltipCache[d])}else{a.tooltipRemote(f,b,e)}},c)},updateChart:function(e,c,b){if(!e){return}var f=e.highcharts();if(c.chart.xAxis&&c.chart.xAxis.title){f.xAxis[0].setTitle(c.chart.xAxis.title,false)}while(f.series[0]){f.series[0].remove(false)}var g=[];var d=0;for(var a in b.series){g[d]={data:b.series[a],name:"chart-"+a,index:d};d++}if(c.seriesReverse){g=g.reverse()}for(var a in g){f.addSeries(g[a],false)}f.redraw()}};